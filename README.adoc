= kopring

ifndef::imagesdir[:imagesdir: images]
image::kopring.png[scaledwidth=10%]
:toc:

= 컨트롤러 활용
``` kotlin
@Controller
class MainController {

    @GetMapping("")
    @ResponseBody
    fun mainGetMap(model : Model): String {
        return "test"
    }
}
```

= JUnit을 사용한 테스트
``` kotlin
    @Test
    fun mainGetMap() {
        println(">> Assert getMapping()")
        val entity = restTemplate.getForEntity<String>("/")
        assertThat(entity.statusCode).isEqualTo(HttpStatus.OK)
        assertThat(entity.body).contains("test")
    }
```

= JPA  활용
== JPA 사용하는 이유
1. 생산성 => JDBC API와 SQL 문을 모두 작성해야하는 문제 해결
2. 유지 보수 => SQL에 의존하지 않기 때문에 수정할 코드가 줄어듦
3. 성능  => JPA라이브러리는 수많은 최적화로 내가 짜는거보다 성능 좋음!

== Entity 생성 기초

[source,kotlin]
----
@Entity
@Table (name = "MEMBER")
data class Member (
    @Id
    @Column(name = "ID")
    private val id : String?,

)
----

== 메인 코드
=== 엔티티 매니저 설정

[source,kotlin]
----
	val emf = Persistence.createEntityManagerFactory("jpaTest")
	val em = emf.createEntityManager()
----

=== 트랜잭션 관리

[source,kotlin]
----
	val tx = em.transaction
	try {
		tx.begin()
		logic(em)
		tx.commit()
	} catch (e: Exception) {
		tx.rollback()
	} finally {
		em.close()
	}
----
