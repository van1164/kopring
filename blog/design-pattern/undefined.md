# 싱글톤 패턴

### ✍ 싱글톤 패턴 <a href="#undefined" id="undefined"></a>

싱글톤 패턴은 하나의 클래스에 오직 하나의 인스턴스만 가지는 패턴이다. 보통 데이터베이스 연결 모듈에 많이 사용한다.

하나의 인스턴스를 다른 모듈들이 공유하며 사용하기 때문에 인스턴스를 생성할 때 드는 비용이 줄어드는 장점이 있다.

서버의 경우 초당 수 많은 요청이 도착하고 처리되어야 하기 때문에 요청마다 객체를 생성하고 또 GC에서 메모리를 관리하는 것은 큰 오버헤드가 발생한다. 그래서 스프링은 요청을 처리하는 객체를 하나만 만들고 공유해서 사용하도록 동작한다.

하지만 싱글톤 패턴에도 단점이 존재한다.

#### ❌ 단점 <a href="#undefined" id="undefined"></a>

* 생성자가 private로 구현되어 있어서 객체지향의 특징을 활용할 수 없다.
* 의존성이 매우 높아진다.
* 단위 테스트시 테스트가 서로 독립적이어야 하는데, 독립적인 인스턴스를 생성하기 어려우며 Mock 객체로 대체하기도 어려운 싱글톤 객체는 테스트가 어렵다.
* 전역상태를 만들기 때문에 객체지향적으로 보았을 때 바람직하지 못하다.

#### 💘 싱글톤 레지스트리 <a href="#undefined" id="undefined"></a>

스프링에서는 위와 같은 단점들로 인해 기본적인 싱글톤 패턴을 그대로 사용하기 보다는 단점을 보완하여 사용하며, 보완된 형태를 **싱글톤 레지스트리**라고 한다.

**싱글톤 레지스트리**는 생성, 관계설정, 사용에 대한 제어권을 가지고 일반 자바 클래스를 싱글톤으로 관리할 수 있다. 스프링 컨테이너가 싱글톤 레지스트리 역할을 하며 빈을 싱글톤으로 관리한다.

따라서, 각 클래스의 public 생성자를 사용할 수 있기 때문에 새로운 오브젝트 생성과 Mock으로 대체가 가능하여 테스트가 용이해진다.\
또한, 일반 자바 클래스이기 때문에 객체지향적인 설계와 디자인 패턴 적용이 가능하다.

#### 💠 의존성 주입 <a href="#undefined" id="undefined"></a>

일반적인 싱글톤 패턴의 단점인 **`의존성이 높아진다.`** 는 모듈간의 결합이 강하다는 말이기도 하다.

싱글톤 패턴을 사용하면 인터페이스를 사용하더라도 싱글톤 인스턴스를 사용하기 위해서 구체적인 싱글톤 클래스를 알고 있어야한다.

이러면 모듈간 결합이 강하기 때문에 싱글톤의 인스턴스가 변경되면 해당 인스턴스를 참조하는 모든 클래스들을 수정해야한다.\
![](https://velog.velcdn.com/images/van1164/post/aadde34e-0cda-452f-86b7-93dda3d61a54/image.png)

**의존성 주입**은 모듈간의 결합을 느슨하게 만들어줄 수 있는 방법이다. 스프링 컨테이너가 클래스들을 빈으로 생성하고, 각 빈들이 의존하고 있는 클래스들의 의존성을 주입해준다.

**의존성 주입**의 장점은 모듈간의 결합도를 낮출 수 있고, 이로 인해 의존성 방향을 일관되게 설정할 수 있다.
